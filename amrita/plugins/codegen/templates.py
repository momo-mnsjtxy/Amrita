"""
代码生成模板库

包含各种代码生成模板，用户可以根据需求选择不同的模板类型
"""

from typing import Any

# 代码模板库
CODE_TEMPLATES: list[dict[str, Any]] = [
    {
        "name": "function",
        "description": "生成函数",
        "prompt_template": """为以下需求生成一个{language}函数：

需求描述：
{description}

具体要求：
{features}

代码要求：
1. 包含适当的错误处理和输入验证
2. 编写清晰的文档字符串，说明参数、返回值和功能
3. 遵循{language}的最佳实践
4. 包含使用示例和测试用例
5. 考虑边界情况和异常处理

生成的代码："""
    },
    {
        "name": "class",
        "description": "生成类",
        "prompt_template": """为以下需求生成一个{language}类：

需求描述：
{description}

具体要求：
{features}

设计原则：
1. 使用面向对象设计原则（封装、继承、多态）
2. 包含适当的属性和方法
3. 实现构造函数__init__和__str__等特殊方法
4. 添加清晰的方法和类级文档字符串
5. 使用私有方法和属性保护内部状态
6. 提供简单的使用示例
7. 考虑线程安全和并发访问

生成的代码："""
    },
    {
        "name": "script",
        "description": "生成完整脚本",
        "prompt_template": """为以下需求生成一个完整的{language}脚本：

需求描述：
{description}

具体要求：
{features}

完整脚本要求：
1. 包含完整的命令行接口（CLI解析）
2. 添加详细的使用说明--help信息
3. 处理各种错误情况并提供友好的错误消息
4. 添加版本信息、作者信息和许可证头
5. 包含日志记录功能
6. 支持配置文件和环境变量
7. 提供代码注释说明重要逻辑
8. 包含主函数保护和入口点

生成的代码："""
    },
    {
        "name": "api",
        "description": "生成API接口",
        "prompt_template": """为以下需求生成一个{language} API接口：

需求描述：
{description}

具体要求：
{features}

REST API要求：
1. 遵循REST架构风格和最佳实践
2. 包含适当的HTTP方法（GET/POST/PUT/DELETE）
3. 实现输入验证和数据序列化
4. 添加完整的错误处理和HTTP状态码
5. 实现适当的认证和授权机制
6. 支持JSON格式的请求和响应
7. 包含API文档和Swagger/OpenAPI定义
8. 实现限速和请求日志记录
9. 考虑安全因素（SQL注入、XSS等预防）
10. 提供简单的API示例和健康检查端点

生成的代码："""
    },
    {
        "name": "algorithm",
        "description": "生成算法实现",
        "prompt_template": """为以下需求生成一个{language}算法实现：

算法需求：
{description}

具体要求：
{features}

算法实现要求：
1. 使用高效的算法和数据结构
2. 提供时间复杂度和空间复杂度分析
3. 包含详细的算法说明和注释
4. 处理边界情况和输入验证
5. 提供多种实现方式（如果适用）
6. 包含性能基准测试代码
7. 支持不同规模的数据输入
8. 考虑内存优化和并行化（如果适用）

生成的代码："""
    },
    {
        "name": "unittest",
        "description": "生成单元测试",
        "prompt_template": """为以下需求生成{language}单元测试代码：

测试需求：
{description}

被测试的功能：
{features}

单元测试要求：
1. 遵循Arrange-Act-Assert模式
2. 覆盖正常情况、边界情况和异常情况
3. 每个测试用例只测试一个功能点
4. 使用描述性的测试方法名称
5. 包含测试夹具和测试数据
6. 实现setUp和tearDown方法进行清理
7. 测试方法覆盖率大于80%
8. 包含性能测试和压力测试
9. 支持测试并行执行
10. 生成详细的测试报告

生成的代码："""
    },
    {
        "name": "database",
        "description": "生成数据库操作代码",
        "prompt_template": """为以下需求生成{language}数据库操作代码：

需求描述：
{description}

数据库操作要求：
{features}

数据库代码要求：
1. 使用参数化查询防止SQL注入
2. 包含连接池管理和连接复用
3. 实现事务管理和回滚机制
4. 包含数据库迁移脚本
5. 支持主从复制和负载均衡（如适用）
6. 实现数据验证和约束检查
7. 包含数据备份和恢复代码
8. 支持查询优化和索引创建
9. 包含数据库监控和性能分析
10. 支持多种数据库后端

生成的代码："""
    }
]

# 语言增强提示词，特定语言的额外要求
LANGUAGE_ENHANCEMENTS = {
    "python": [
        "遵循PEP 8编码规范",
        "使用类型提示和类型注解",
        "提供__all__导出列表",
        "支持async/await（如适用）",
        "使用with语句进行资源管理"
    ],
    "javascript": [
        "遵循ES6+语法标准",
        "使用const和let代替var",
        "使用箭头函数和模板字符串",
        "遵循Airbnb或Google风格指南",
        "支持Promise和async/await"
    ],
    "java": [
        "遵循Java命名规范和代码约定",
        "使用接口进行抽象设计",
        "实现适当的异常处理",
        "使用泛型而不是原始类型",
        "遵循单一职责原则"
    ],
    "cpp": [
        "遵循现代C++标准（C++11及以上）",
        "使用智能指针管理内存",
        "避免原始选择的内存管理",
        "考虑移动语义和右值引用",
        "使用const正确性"
    ]
}

# 常用的代码模式模板
CODE_PATTERNS = {
    "singleton": "单例模式 - 确保一个类只有一个实例",
    "factory": "工厂模式 - 创建对象的最佳实践",
    "observer": "观察者模式 - 实现发布/订阅机制",
    "strategy": "策略模式 - 定义算法族",
    "decorator": "装饰器模式 - 动态添加功能"
}

# 安全代码检查清单
SECURITY_CHECKLIST = [
    "验证所有用户输入",
    "处理空指针和边界情况",
    "使用安全的加密算法",
    "避免硬编码敏感信息",
    "实现适当的日志记录",
    "避免SQL注入和XSS攻击",
    "使用参数化查询",
    "验证后的数据仍需验证"
]
